<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Resizer - NexaTools</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- JSZip for creating zip files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        .header-scrolled {
            background-color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .dark .header-scrolled {
            background-color: rgba(15, 23, 42, 0.8);
        }
        .drag-over {
            border-color: #3b82f6;
            background-color: rgb(59 130 246 / 0.05);
        }
        .dark .drag-over {
            background-color: rgb(59 130 246 / 0.1);
        }
        /* Custom styles for aspect ratio lock */
        #aspect-lock-btn.locked {
            background-color: #3b82f6; /* brand-blue */
            color: white;
            border-color: #3b82f6;
        }
        .dark #aspect-lock-btn.locked {
             background-color: #3b82f6;
             border-color: #3b82f6;
        }
    </style>
    <script>
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark')
        } else {
            document.documentElement.classList.remove('dark')
        }

        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brand: {
                            blue: '#3b82f6',
                            green: '#10b981',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-slate-50 dark:bg-slate-900 text-slate-800 dark:text-slate-200 transition-colors duration-300 flex flex-col min-h-screen">

    <!-- =========== HEADER =========== -->
    <header id="header" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-bold text-slate-900 dark:text-white">Nexa<span class="text-brand-blue">Tools</span></a>
            <nav class="hidden md:flex items-center space-x-8">
                <a href="index.html" class="text-slate-600 dark:text-slate-300 hover:text-brand-blue dark:hover:text-brand-blue transition-colors">Home</a>
                <a href="index.html#tools" class="text-brand-blue font-semibold">Tools</a>
                <a href="#" class="text-slate-600 dark:text-slate-300 hover:text-brand-blue dark:hover:text-brand-blue transition-colors">About</a>
                <a href="#" class="text-slate-600 dark:text-slate-300 hover:text-brand-blue dark:hover:text-brand-blue transition-colors">Contact</a>
            </nav>
            <div class="flex items-center">
                <button id="theme-toggle" class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">
                    <svg id="theme-toggle-dark-icon" class="hidden h-5 w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
                    <svg id="theme-toggle-light-icon" class="hidden h-5 w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 5.05A1 1 0 003.636 6.464l.707.707a1 1 0 001.414-1.414l-.707-.707zM3 11a1 1 0 100-2H2a1 1 0 100 2h1zM6.464 16.364l.707-.707a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414z" fill-rule="evenodd" clip-rule="evenodd"></path></svg>
                </button>
            </div>
        </div>
    </header>

    <main class="flex-grow pt-24 pb-12">
        <div class="container mx-auto px-4">
            <!-- Tool Header -->
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-5xl font-extrabold text-slate-900 dark:text-white flex items-center justify-center gap-4">
                    <span class="text-brand-blue">
                       <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15" /></svg>
                    </span>
                    Image Resizer
                </h1>
                <p class="mt-4 text-lg md:text-xl max-w-2xl mx-auto text-slate-600 dark:text-slate-300">Change the dimensions of your images by pixels or percentage.</p>
            </div>
            
            <!-- Tool UI -->
            <div class="max-w-4xl mx-auto bg-white dark:bg-slate-800 rounded-xl shadow-lg p-6 md:p-8">
                
                <!-- Upload Area -->
                <div id="drop-zone" class="border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-lg p-8 text-center cursor-pointer transition-all duration-300">
                    <div class="flex flex-col items-center justify-center space-y-4 text-slate-500 dark:text-slate-400">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1"><path stroke-linecap="round" stroke-linejoin="round" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" /></svg>
                        <p class="text-lg font-semibold">Drag & drop image files here</p>
                        <p>or</p>
                        <button id="select-files-btn" class="bg-brand-blue text-white font-bold py-2 px-6 rounded-lg shadow-md hover:bg-blue-600 transition-colors">Select Files</button>
                        <input type="file" id="file-input" class="hidden" multiple accept="image/*">
                    </div>
                </div>

                <!-- Options & File Queue -->
                <div id="processing-section" class="hidden mt-8">
                    <!-- Resizing Options -->
                    <div class="bg-slate-100 dark:bg-slate-700/50 p-4 rounded-lg space-y-6">
                        <!-- Resize By -->
                        <div>
                            <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">Resize by:</label>
                            <div class="flex gap-4">
                                <label class="flex items-center"><input type="radio" name="resize-by" value="pixels" class="h-4 w-4 text-brand-blue focus:ring-brand-blue" checked> <span class="ml-2">Pixels</span></label>
                                <label class="flex items-center"><input type="radio" name="resize-by" value="percentage" class="h-4 w-4 text-brand-blue focus:ring-brand-blue"> <span class="ml-2">Percentage</span></label>
                            </div>
                        </div>

                        <!-- Pixel Options -->
                        <div id="pixel-options">
                            <div class="flex items-end gap-3">
                                <div class="flex-1">
                                    <label for="width-input" class="block text-xs font-medium text-slate-700 dark:text-slate-300">Width (px)</label>
                                    <input type="number" id="width-input" min="1" class="mt-1 w-full bg-white dark:bg-slate-800 border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:ring-brand-blue focus:border-brand-blue">
                                </div>
                                <button id="aspect-lock-btn" title="Maintain aspect ratio" class="h-10 w-10 border border-slate-300 dark:border-slate-600 rounded-md flex items-center justify-center text-slate-400 dark:text-slate-500 transition-colors locked">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0l-1.5-1.5a2 2 0 112.828-2.828l1.5 1.5l3-3z" clip-rule="evenodd" /><path fill-rule="evenodd" d="M6.414 11.586a2 2 0 10-2.828 2.828l3 3a2 2 0 002.828 0l1.5-1.5a2 2 0 10-2.828-2.828l-1.5 1.5-3-3z" clip-rule="evenodd" /></svg>
                                </button>
                                <div class="flex-1">
                                    <label for="height-input" class="block text-xs font-medium text-slate-700 dark:text-slate-300">Height (px)</label>
                                    <input type="number" id="height-input" min="1" class="mt-1 w-full bg-white dark:bg-slate-800 border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:ring-brand-blue focus:border-brand-blue">
                                </div>
                            </div>
                        </div>

                        <!-- Percentage Options -->
                        <div id="percentage-options" class="hidden">
                             <label for="percentage-input" class="block text-sm font-medium text-slate-700 dark:text-slate-300">Scale</label>
                             <div class="flex items-center gap-3 mt-1">
                                <input type="number" id="percentage-input" min="1" max="500" value="50" class="w-24 bg-white dark:bg-slate-800 border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:ring-brand-blue focus:border-brand-blue">
                                <span class="text-slate-600 dark:text-slate-300">%</span>
                             </div>
                        </div>

                        <!-- Output Format & Quality -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="format-select" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Output format:</label>
                                <select id="format-select" class="w-full bg-white dark:bg-slate-800 border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:ring-brand-blue focus:border-brand-blue">
                                    <option value="jpg">JPG</option>
                                    <option value="png">PNG</option>
                                    <option value="webp">WEBP</option>
                                </select>
                            </div>
                            <div id="quality-control">
                                <label for="quality-slider" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Quality: <span id="quality-value">80</span>%</label>
                                <input id="quality-slider" type="range" min="1" max="100" value="80" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer dark:bg-slate-600">
                            </div>
                        </div>
                    </div>

                    <!-- File List -->
                    <div id="file-list" class="mt-6 space-y-3"></div>
                    
                    <!-- Action Buttons -->
                    <div class="mt-8 flex flex-col sm:flex-row gap-4">
                        <button id="resize-btn" class="w-full sm:w-auto flex-1 bg-brand-green text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-green-600 transition-colors flex items-center justify-center gap-2">
                             Resize
                        </button>
                        <button id="download-all-btn" class="w-full sm:w-auto hidden bg-brand-blue text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-blue-600 transition-colors flex items-center justify-center gap-2">
                            Download All (.zip)
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- =========== FOOTER =========== -->
    <footer class="bg-slate-100 dark:bg-slate-800/50 border-t border-slate-200 dark:border-slate-700/50 mt-auto">
        <div class="container mx-auto px-4 py-8">
            <div class="flex flex-col md:flex-row justify-between items-center text-center md:text-left space-y-4 md:space-y-0">
                <div>
                    <a href="index.html" class="text-xl font-bold text-slate-900 dark:text-white">Nexa<span class="text-brand-blue">Tools</span></a>
                    <p class="text-sm text-slate-500 dark:text-slate-400">Simplifying your digital life.</p>
                </div>
                <div class="text-sm text-slate-600 dark:text-slate-400">
                    <p>contact@nexatools.com</p>
                    <p class="mt-1">© 2024 NexaTools. All Rights Reserved.</p>
                </div>
                <div class="flex space-x-4 text-sm">
                    <a href="#" class="text-slate-600 dark:text-slate-400 hover:text-brand-blue dark:hover:text-brand-blue">Privacy Policy</a>
                    <a href="#" class="text-slate-600 dark:text-slate-400 hover:text-brand-blue dark:hover:text-brand-blue">Terms of Use</a>
                </div>
            </div>
        </div>
    </footer>

<script>
document.addEventListener('DOMContentLoaded', function() {
    
    // --- THEME & HEADER LOGIC ---
    // (Identical to previous pages for consistency)
    const header = document.getElementById('header');
    const themeToggleBtn = document.getElementById('theme-toggle');
    const darkIcon = document.getElementById('theme-toggle-dark-icon');
    const lightIcon = document.getElementById('theme-toggle-light-icon');
    const toggleTheme = () => { document.documentElement.classList.toggle('dark'); localStorage.theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light'; updateThemeIcons(); };
    const updateThemeIcons = () => { if (document.documentElement.classList.contains('dark')) { darkIcon.classList.remove('hidden'); lightIcon.classList.add('hidden'); } else { darkIcon.classList.add('hidden'); lightIcon.classList.remove('hidden'); } };
    themeToggleBtn.addEventListener('click', toggleTheme);
    updateThemeIcons();
    window.addEventListener('scroll', () => { header.classList.toggle('header-scrolled', window.scrollY > 10); });

    // --- IMAGE RESIZER LOGIC ---
    const dropZone = document.getElementById('drop-zone');
    const fileInput = document.getElementById('file-input');
    const selectFilesBtn = document.getElementById('select-files-btn');
    const processingSection = document.getElementById('processing-section');
    const fileListElem = document.getElementById('file-list');
    const resizeBtn = document.getElementById('resize-btn');
    const downloadAllBtn = document.getElementById('download-all-btn');

    // Options
    const resizeByRadios = document.querySelectorAll('input[name="resize-by"]');
    const pixelOptions = document.getElementById('pixel-options');
    const percentageOptions = document.getElementById('percentage-options');
    const widthInput = document.getElementById('width-input');
    const heightInput = document.getElementById('height-input');
    const aspectLockBtn = document.getElementById('aspect-lock-btn');
    const percentageInput = document.getElementById('percentage-input');
    const formatSelect = document.getElementById('format-select');
    const qualityControl = document.getElementById('quality-control');
    const qualitySlider = document.getElementById('quality-slider');
    const qualityValue = document.getElementById('quality-value');

    let filesToProcess = [];
    let aspectRatios = {}; // Store aspect ratio for each file
    let isLocked = true;
    let lastEdited = 'width';

    // --- Event Listeners ---
    selectFilesBtn.addEventListener('click', () => fileInput.click());
    fileInput.addEventListener('change', () => handleFiles(fileInput.files));
    dropZone.addEventListener('dragover', (e) => { e.preventDefault(); e.stopPropagation(); dropZone.classList.add('drag-over'); });
    dropZone.addEventListener('dragleave', (e) => { e.preventDefault(); e.stopPropagation(); dropZone.classList.remove('drag-over'); });
    dropZone.addEventListener('drop', (e) => { e.preventDefault(); e.stopPropagation(); dropZone.classList.remove('drag-over'); handleFiles(e.dataTransfer.files); });

    resizeByRadios.forEach(radio => radio.addEventListener('change', toggleResizeOptions));
    aspectLockBtn.addEventListener('click', () => { isLocked = !isLocked; aspectLockBtn.classList.toggle('locked', isLocked); });
    widthInput.addEventListener('input', () => { lastEdited = 'width'; handleDimensionChange(); });
    heightInput.addEventListener('input', () => { lastEdited = 'height'; handleDimensionChange(); });
    qualitySlider.addEventListener('input', () => qualityValue.textContent = qualitySlider.value);
    formatSelect.addEventListener('change', () => qualityControl.style.display = ['jpg', 'webp'].includes(formatSelect.value) ? 'block' : 'none');
    resizeBtn.addEventListener('click', processResize);
    downloadAllBtn.addEventListener('click', downloadAllAsZip);


    function toggleResizeOptions() {
        const selected = document.querySelector('input[name="resize-by"]:checked').value;
        pixelOptions.style.display = selected === 'pixels' ? 'block' : 'none';
        percentageOptions.style.display = selected === 'percentage' ? 'block' : 'none';
    }

    function handleDimensionChange() {
        if (!isLocked || filesToProcess.length === 0) return;
        
        const firstFile = filesToProcess[0];
        const ratio = aspectRatios[firstFile.name];
        if (!ratio) return;

        const width = parseInt(widthInput.value, 10);
        const height = parseInt(heightInput.value, 10);
        
        if (lastEdited === 'width' && width > 0) {
            heightInput.value = Math.round(width / ratio);
        } else if (lastEdited === 'height' && height > 0) {
            widthInput.value = Math.round(height * ratio);
        }
    }

    async function handleFiles(files) {
        const newFiles = Array.from(files).filter(file => file.type.startsWith('image/'));
        for (const file of newFiles) {
            if (!filesToProcess.some(f => f.name === file.name && f.size === file.size)) {
                filesToProcess.push(file);
                // Pre-calculate and store aspect ratio
                try {
                    const { width, height } = await getImageDimensions(file);
                    aspectRatios[file.name] = width / height;
                } catch (error) {
                    console.error("Could not get image dimensions for:", file.name);
                }
            }
        }
        updateFileList();
        if (filesToProcess.length > 0) {
            processingSection.classList.remove('hidden');
            if (!widthInput.value && !heightInput.value) {
                // Pre-fill dimensions from first image
                const firstFile = filesToProcess[0];
                const { width, height } = await getImageDimensions(firstFile);
                widthInput.value = width;
                heightInput.value = height;
            }
        }
    }

    function getImageDimensions(file) {
        return new Promise((resolve, reject) => {
            const img = new Image();
            img.onload = () => resolve({ width: img.width, height: img.height });
            img.onerror = reject;
            img.src = URL.createObjectURL(file);
        });
    }

    function formatFileSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    async function updateFileList() {
        fileListElem.innerHTML = '';
        for (const [index, file] of filesToProcess.entries()) {
            const { width, height } = await getImageDimensions(file);
            const fileItem = document.createElement('div');
            fileItem.className = 'bg-slate-50 dark:bg-slate-700/60 p-3 rounded-lg flex items-center justify-between gap-2';
            fileItem.dataset.index = index;

            fileItem.innerHTML = `
                <div class="flex items-center gap-3 flex-1 min-w-0">
                    <img src="${URL.createObjectURL(file)}" alt="${file.name}" class="w-12 h-12 object-cover rounded-md flex-shrink-0">
                    <div class="flex-1 min-w-0">
                        <p class="font-semibold text-sm text-slate-800 dark:text-slate-100 truncate">${file.name}</p>
                        <p class="text-xs text-slate-500 dark:text-slate-400">Original: ${width} x ${height}px</p>
                    </div>
                </div>
                <div class="file-status text-sm text-right flex-shrink-0"></div>
                <button title="Remove" class="remove-btn p-1 text-slate-400 hover:text-red-500 dark:hover:text-red-400 flex-shrink-0">×</button>
            `;
            
            fileItem.querySelector('.remove-btn').addEventListener('click', (e) => {
                e.stopPropagation();
                filesToProcess.splice(index, 1);
                delete aspectRatios[file.name];
                updateFileList();
                if (filesToProcess.length === 0) {
                    processingSection.classList.add('hidden');
                }
            });
            fileListElem.appendChild(fileItem);
        }
        resetResizeButton();
    }
    
    function resetResizeButton() {
        resizeBtn.disabled = filesToProcess.length === 0;
        resizeBtn.innerHTML = `Resize`;
        downloadAllBtn.classList.add('hidden');
    }

    async function processResize() {
        resizeBtn.disabled = true;
        resizeBtn.innerHTML = `<svg class="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Resizing...`;

        const resizeMode = document.querySelector('input[name="resize-by"]:checked').value;
        const quality = qualitySlider.value / 100;
        const format = formatSelect.value;
        const mimeType = `image/${format === 'jpg' ? 'jpeg' : format}`;
        
        const resizePromises = filesToProcess.map((file, index) => {
            const fileItem = fileListElem.querySelector(`[data-index='${index}']`);
            const statusElem = fileItem.querySelector('.file-status');
            statusElem.innerHTML = `<span class="text-xs text-slate-500">Processing...</span>`;

            return new Promise(async (resolve, reject) => {
                const img = new Image();
                img.onload = () => {
                    let targetWidth, targetHeight;
                    const originalRatio = img.width / img.height;

                    if (resizeMode === 'pixels') {
                        const w = parseInt(widthInput.value, 10);
                        const h = parseInt(heightInput.value, 10);
                        if (!w && !h) { reject(new Error('No dimensions specified')); return; }
                        
                        if (isLocked) {
                            if (w && !h) {
                                targetWidth = w;
                                targetHeight = Math.round(w / originalRatio);
                            } else if (!w && h) {
                                targetHeight = h;
                                targetWidth = Math.round(h * originalRatio);
                            } else { // both specified, prioritize last edited or width
                                targetWidth = w;
                                targetHeight = Math.round(w / originalRatio);
                            }
                        } else {
                            targetWidth = w || img.width;
                            targetHeight = h || img.height;
                        }
                    } else { // percentage
                        const p = parseInt(percentageInput.value, 10) / 100;
                        targetWidth = Math.round(img.width * p);
                        targetHeight = Math.round(img.height * p);
                    }
                    
                    const canvas = document.createElement('canvas');
                    canvas.width = targetWidth;
                    canvas.height = targetHeight;
                    const ctx = canvas.getContext('2d');
                    if (format === 'jpg') { ctx.fillStyle = '#FFFFFF'; ctx.fillRect(0, 0, canvas.width, canvas.height); }
                    ctx.drawImage(img, 0, 0, targetWidth, targetHeight);

                    canvas.toBlob((blob) => {
                        const originalName = file.name.substring(0, file.name.lastIndexOf('.'));
                        const newFileName = `${originalName}.${format}`;
                        const downloadUrl = URL.createObjectURL(blob);
                        statusElem.innerHTML = `
                            <div>
                                <p class="font-semibold text-green-600 dark:text-green-400">${targetWidth}x${targetHeight}px</p>
                                <p class="text-xs text-slate-500 dark:text-slate-400">${formatFileSize(blob.size)}</p>
                            </div>
                            <a href="${downloadUrl}" download="${newFileName}" class="ml-3 bg-blue-100 dark:bg-blue-900/50 text-brand-blue text-xs font-bold py-1 px-3 rounded-full hover:bg-blue-200 dark:hover:bg-blue-800/80">Download</a>
                        `;
                        resolve({ blob, fileName: newFileName });
                    }, mimeType, quality);
                };
                img.onerror = reject;
                img.src = URL.createObjectURL(file);
            });
        });

        try {
            const results = await Promise.all(resizePromises);
            window.resizedFiles = results;
            if (results.length > 0) {
                downloadAllBtn.classList.remove('hidden');
            }
        } catch (error) {
            console.error("Resizing failed:", error);
            // Optionally show an error message to the user
        } finally {
            resetResizeButton();
        }
    }
    
    function downloadAllAsZip() {
        if (!window.resizedFiles || window.resizedFiles.length === 0) return;
        const zip = new JSZip();
        window.resizedFiles.forEach(file => zip.file(file.fileName, file.blob));
        zip.generateAsync({ type: "blob" }).then(content => {
            const link = document.createElement('a');
            link.href = URL.createObjectURL(content);
            link.download = "NexaTools_Resized_Images.zip";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });
    }

});
</script>

</body>
</html>